update
[sudo] password for hunter:
warning: Git tree '/home/hunter/.dots' is dirty
➜  .dots git:(main) ✗ update
warning: Git tree '/home/hunter/.dots' is dirty
➜  .dots git:(main) ✗ update --show-trace > error.log
warning: Git tree '/home/hunter/.dots' is dirty
building the system configuration...
warning: Git tree '/home/hunter/.dots' is dirty
error:
       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1529:14:
         1528|         zipAttrsWith (
         1529|           n: values:
             |              ^
         1530|           let

       … while calling the 'head' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1534:13:
         1533|           if length values == 1 || pred here (elemAt values 1) (head values) then
         1534|             head values
             |             ^
         1535|           else

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `system.build.toplevel':

       … while evaluating the attribute 'mergedValue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1131:5:
         1130|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
         1131|     mergedValue =
             |     ^
         1132|       if isDefined then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1132:7:
         1131|     mergedValue =
         1132|       if isDefined then
             |       ^
         1133|         if all (def: type.check def.value) defsFinal then

       … while evaluating the attribute 'values'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1125:9:
         1124|       {
         1125|         values = defs''';
             |         ^
         1126|         inherit (defs'') highestPrio;

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1119:11:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |           ^
         1120|             sortProperties defs''.values

       … while calling the 'any' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1119:14:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |              ^
         1120|             sortProperties defs''.values

       … while evaluating the attribute 'values'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1252:7:
         1251|     {
         1252|       values = concatMap (def: if getPrio def == highestPrio then [ (strip def) ] else [ ]) defs;
             |       ^
         1253|       inherit highestPrio;

       … while calling the 'concatMap' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1252:16:
         1251|     {
         1252|       values = concatMap (def: if getPrio def == highestPrio then [ (strip def) ] else [ ]) defs;
             |                ^
         1253|       inherit highestPrio;

       … while calling the 'concatMap' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1099:17:
         1098|         # Process mkMerge and mkIf properties.
         1099|         defs' = concatMap (
             |                 ^
         1100|           m:

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1100:11:
         1099|         defs' = concatMap (
         1100|           m:
             |           ^
         1101|           map (

       … while calling the 'map' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1101:11:
         1100|           m:
         1101|           map (
             |           ^
         1102|             value:

       … while evaluating definitions from `/nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/activation/top-level.nix':

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:770:21:
          769|             inherit (module) file;
          770|             inherit value;
             |                     ^
          771|           }) module.config

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/activation/top-level.nix:80:26:
           79|   # Handle assertions and warnings
           80|   baseSystemAssertWarn = lib.asserts.checkAssertWarn config.assertions config.warnings baseSystem;
             |                          ^
           81|

       … while calling 'checkAssertWarn'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/asserts.nix:193:27:
          192|   checkAssertWarn =
          193|     assertions: warnings: val:
             |                           ^
          194|     let

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/asserts.nix:200:7:
          199|     else
          200|       showWarnings warnings val;
             |       ^
          201|

       … while calling 'showWarnings'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/trivial.nix:962:28:
          961|
          962|   showWarnings = warnings: res: lib.foldr (w: x: warn w x) res warnings;
             |                            ^
          963|

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/trivial.nix:962:33:
          961|
          962|   showWarnings = warnings: res: lib.foldr (w: x: warn w x) res warnings;
             |                                 ^
          963|

       … while calling 'foldr'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:139:14:
          138|   foldr =
          139|     op: nul: list:
             |              ^
          140|     let

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:144:5:
          143|     in
          144|     fold' 0;
             |     ^
          145|

       … while calling 'fold''
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:142:15:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |               ^
          143|     in

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:142:18:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |                  ^
          143|     in

       … while calling the 'length' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:141:13:
          140|     let
          141|       len = length list;
             |             ^
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/activation/top-level.nix:80:72:
           79|   # Handle assertions and warnings
           80|   baseSystemAssertWarn = lib.asserts.checkAssertWarn config.assertions config.warnings baseSystem;
             |                                                                        ^
           81|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `warnings':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix':

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:770:21:
          769|             inherit (module) file;
          770|             inherit value;
             |                     ^
          771|           }) module.config

       … while calling the 'concatLists' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:533:7:
          532|       in
          533|       concatLists (
             |       ^
          534|         mapAttrsToList (

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:535:17:
          534|         mapAttrsToList (
          535|           name: service:
             |                 ^
          536|           let

       … while calling the 'concatLists' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:541:11:
          540|           in
          541|           concatLists [
             |           ^
          542|             (optional (type == "oneshot" && (restart == "always" || restart == "on-success"))

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:542:14:
          541|           concatLists [
          542|             (optional (type == "oneshot" && (restart == "always" || restart == "on-success"))
             |              ^
          543|               "Service '${name}.service' with 'Type=oneshot' cannot have 'Restart=always' or 'Restart=on-success'"

       … while calling 'optional'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:777:20:
          776|   */
          777|   optional = cond: elem: if cond then [ elem ] else [ ];
             |                    ^
          778|

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:777:26:
          776|   */
          777|   optional = cond: elem: if cond then [ elem ] else [ ];
             |                          ^
          778|

       … in the left operand of the AND (&&) operator
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:542:42:
          541|           concatLists [
          542|             (optional (type == "oneshot" && (restart == "always" || restart == "on-success"))
             |                                          ^
          543|               "Service '${name}.service' with 'Type=oneshot' cannot have 'Restart=always' or 'Restart=on-success'"

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:537:20:
          536|           let
          537|             type = service.serviceConfig.Type or "";
             |                    ^
          538|             restart = service.serviceConfig.Restart or "no";

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `systemd.services.home-manager-hunter.serviceConfig':

       … while evaluating the attribute 'mergedValue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1131:5:
         1130|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
         1131|     mergedValue =
             |     ^
         1132|       if isDefined then

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1134:11:
         1133|         if all (def: type.check def.value) defsFinal then
         1134|           type.merge loc defsFinal
             |           ^
         1135|         else

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:831:22:
          830|                 # Non-lazy merge Function
          831|                 loc: defs:
             |                      ^
          832|                 mapAttrs (n: v: v.value) (

       … while calling the 'mapAttrs' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:832:17:
          831|                 loc: defs:
          832|                 mapAttrs (n: v: v.value) (
             |                 ^
          833|                   filterAttrs (n: v: v ? value) (

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:833:19:
          832|                 mapAttrs (n: v: v.value) (
          833|                   filterAttrs (n: v: v ? value) (
             |                   ^
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)

       … while calling 'filterAttrs'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:23:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                       ^
          658|

       … while calling the 'removeAttrs' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:28:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                            ^
          658|

       … while calling the 'filter' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:45:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                             ^
          658|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:53:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                     ^
          658|

       … in the argument of the not operator
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:60:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                            ^
          658|

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:60:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                            ^
          658|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:833:35:
          832|                 mapAttrs (n: v: v.value) (
          833|                   filterAttrs (n: v: v ? value) (
             |                                   ^
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:70:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                                      ^
          658|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:834:41:
          833|                   filterAttrs (n: v: v ? value) (
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)
             |                                         ^
          835|                       # Push down position info.

       … while evaluating the attribute 'optionalValue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1148:5:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |     ^
         1149|   };

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1148:21:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |                     ^
         1149|   };

       (8 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/nixos':

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:774:15:
          773|               inherit (def) file;
          774|               value = v;
             |               ^
          775|             }) def.value

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'home-manager-generation'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'buildCommand' of derivation 'home-manager-generation'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:80:17:
           79|         enableParallelBuilding = true;
           80|         inherit buildCommand name;
             |                 ^
           81|         passAsFile = [ "buildCommand" ] ++ (derivationArgs.passAsFile or [ ]);

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'activation-script'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'text' of derivation 'activation-script'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:129:13:
          128|           inherit
          129|             text
             |             ^
          130|             executable

       … while calling the 'concatStringsSep' builtin
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/home-environment.nix:725:13:
          724|           if sortedCommands ? result then
          725|             lib.concatStringsSep "\n" (map mkCmd sortedCommands.result)
             |             ^
          726|           else

       … while calling 'mkCmd'
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/home-environment.nix:718:17:
          717|       let
          718|         mkCmd = res: ''
             |                 ^
          719|           _iNote "Activating %s" "${res.name}"

       … while evaluating the attribute 'data'
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/lib/dag.nix:100:45:
           99|       {
          100|         result = map (v: { inherit (v) name data; }) sorted.result;
             |                                             ^
          101|       }

       … while evaluating the attribute 'data'
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/lib/dag.nix:92:9:
           91|         name = n;
           92|         data = v.data;
             |         ^
           93|         after = v.after ++ dagBefore dag n;

       … from call site
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/lib/dag.nix:92:16:
           91|         name = n;
           92|         data = v.data;
             |                ^
           93|         after = v.after ++ dagBefore dag n;

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `home-manager.users.hunter.home.activation.installPackages.data':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/home-environment.nix':

       (6 duplicate frames omitted)

       … while evaluating derivation 'home-manager-path'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'passAsFile' of derivation 'home-manager-path'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:81:9:
           80|         inherit buildCommand name;
           81|         passAsFile = [ "buildCommand" ] ++ (derivationArgs.passAsFile or [ ]);
             |         ^
           82|       }

       … while evaluating the attribute 'passAsFile'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:9:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |         ^
          114|       }

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:22:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                      ^
          114|       }

       … in the argument of the not operator
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:52:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                                                    ^
          114|       }

       … while calling the 'lessThan' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:52:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                                                    ^
          114|       }

       … while calling the 'stringLength' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:25:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                         ^
          114|       }

       … while calling the 'toJSON' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:108:16:
          107|           ;
          108|         pkgs = builtins.toJSON chosenOutputs;
             |                ^
          109|         extraPathsFrom = lib.optional includeClosures (writeClosure pathsForClosure);

       … while evaluating list element at index 46

       … while evaluating attribute 'paths'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:68:7:
           67|     chosenOutputs = map (drv: {
           68|       paths =
             |       ^
           69|         # First add the usual output(s): respect if user has chosen explicitly,

       … while evaluating list element at index 0
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:68:7:
           67|     chosenOutputs = map (drv: {
           68|       paths =
             |       ^
           69|         # First add the usual output(s): respect if user has chosen explicitly,

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'lutris-0.5.19'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'buildCommand' of derivation 'lutris-0.5.19'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:80:17:
           79|         enableParallelBuilding = true;
           80|         inherit buildCommand name;
             |                 ^
           81|         passAsFile = [ "buildCommand" ] ++ (derivationArgs.passAsFile or [ ]);

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'lutris-0.5.19-bwrap'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'text' of derivation 'lutris-0.5.19-bwrap'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:129:13:
          128|           inherit
          129|             text
             |             ^
          130|             executable

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/default.nix:326:43:
          325|
          326|   bin = writeShellScript "${name}-bwrap" (bwrapCmd {
             |                                           ^
          327|     initArgs = ''"$@"'';

       … while calling 'bwrapCmd'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/default.nix:175:5:
          174|   bwrapCmd =
          175|     {
             |     ^
          176|       initArgs ? "",

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'lutris-0.5.19-fhsenv-rootfs'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'exportReferencesGraph' of derivation 'lutris-0.5.19-fhsenv-rootfs'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/buildFHSEnv.nix:215:9:
          214|         __structuredAttrs = true;
          215|         exportReferencesGraph.graph = lib.concatMap (p: p.paths) allPaths;
             |         ^
          216|         inherit

       … while evaluating attribute 'graph'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/buildFHSEnv.nix:215:9:
          214|         __structuredAttrs = true;
          215|         exportReferencesGraph.graph = lib.concatMap (p: p.paths) allPaths;
             |         ^
          216|         inherit

       … while evaluating list element at index 225
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/buildFHSEnv.nix:215:9:
          214|         __structuredAttrs = true;
          215|         exportReferencesGraph.graph = lib.concatMap (p: p.paths) allPaths;
             |         ^
          216|         inherit

➜  .dots git:(main) ✗ update --show-trace
warning: Git tree '/home/hunter/.dots' is dirty
building the system configuration...
warning: Git tree '/home/hunter/.dots' is dirty
error:
       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1529:14:
         1528|         zipAttrsWith (
         1529|           n: values:
             |              ^
         1530|           let

       … while calling the 'head' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1534:13:
         1533|           if length values == 1 || pred here (elemAt values 1) (head values) then
         1534|             head values
             |             ^
         1535|           else

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `system.build.toplevel':

       … while evaluating the attribute 'mergedValue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1131:5:
         1130|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
         1131|     mergedValue =
             |     ^
         1132|       if isDefined then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1132:7:
         1131|     mergedValue =
         1132|       if isDefined then
             |       ^
         1133|         if all (def: type.check def.value) defsFinal then

       … while evaluating the attribute 'values'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1125:9:
         1124|       {
         1125|         values = defs''';
             |         ^
         1126|         inherit (defs'') highestPrio;

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1119:11:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |           ^
         1120|             sortProperties defs''.values

       … while calling the 'any' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1119:14:
         1118|           # Avoid sorting if we don't have to.
         1119|           if any (def: def.value._type or "" == "order") defs''.values then
             |              ^
         1120|             sortProperties defs''.values

       … while evaluating the attribute 'values'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1252:7:
         1251|     {
         1252|       values = concatMap (def: if getPrio def == highestPrio then [ (strip def) ] else [ ]) defs;
             |       ^
         1253|       inherit highestPrio;

       … while calling the 'concatMap' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1252:16:
         1251|     {
         1252|       values = concatMap (def: if getPrio def == highestPrio then [ (strip def) ] else [ ]) defs;
             |                ^
         1253|       inherit highestPrio;

       … while calling the 'concatMap' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1099:17:
         1098|         # Process mkMerge and mkIf properties.
         1099|         defs' = concatMap (
             |                 ^
         1100|           m:

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1100:11:
         1099|         defs' = concatMap (
         1100|           m:
             |           ^
         1101|           map (

       … while calling the 'map' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1101:11:
         1100|           m:
         1101|           map (
             |           ^
         1102|             value:

       … while evaluating definitions from `/nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/activation/top-level.nix':

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:770:21:
          769|             inherit (module) file;
          770|             inherit value;
             |                     ^
          771|           }) module.config

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/activation/top-level.nix:80:26:
           79|   # Handle assertions and warnings
           80|   baseSystemAssertWarn = lib.asserts.checkAssertWarn config.assertions config.warnings baseSystem;
             |                          ^
           81|

       … while calling 'checkAssertWarn'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/asserts.nix:193:27:
          192|   checkAssertWarn =
          193|     assertions: warnings: val:
             |                           ^
          194|     let

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/asserts.nix:200:7:
          199|     else
          200|       showWarnings warnings val;
             |       ^
          201|

       … while calling 'showWarnings'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/trivial.nix:962:28:
          961|
          962|   showWarnings = warnings: res: lib.foldr (w: x: warn w x) res warnings;
             |                            ^
          963|

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/trivial.nix:962:33:
          961|
          962|   showWarnings = warnings: res: lib.foldr (w: x: warn w x) res warnings;
             |                                 ^
          963|

       … while calling 'foldr'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:139:14:
          138|   foldr =
          139|     op: nul: list:
             |              ^
          140|     let

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:144:5:
          143|     in
          144|     fold' 0;
             |     ^
          145|

       … while calling 'fold''
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:142:15:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |               ^
          143|     in

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:142:18:
          141|       len = length list;
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
             |                  ^
          143|     in

       … while calling the 'length' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:141:13:
          140|     let
          141|       len = length list;
             |             ^
          142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/activation/top-level.nix:80:72:
           79|   # Handle assertions and warnings
           80|   baseSystemAssertWarn = lib.asserts.checkAssertWarn config.assertions config.warnings baseSystem;
             |                                                                        ^
           81|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `warnings':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix':

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:770:21:
          769|             inherit (module) file;
          770|             inherit value;
             |                     ^
          771|           }) module.config

       … while calling the 'concatLists' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:533:7:
          532|       in
          533|       concatLists (
             |       ^
          534|         mapAttrsToList (

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:535:17:
          534|         mapAttrsToList (
          535|           name: service:
             |                 ^
          536|           let

       … while calling the 'concatLists' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:541:11:
          540|           in
          541|           concatLists [
             |           ^
          542|             (optional (type == "oneshot" && (restart == "always" || restart == "on-success"))

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:542:14:
          541|           concatLists [
          542|             (optional (type == "oneshot" && (restart == "always" || restart == "on-success"))
             |              ^
          543|               "Service '${name}.service' with 'Type=oneshot' cannot have 'Restart=always' or 'Restart=on-success'"

       … while calling 'optional'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:777:20:
          776|   */
          777|   optional = cond: elem: if cond then [ elem ] else [ ];
             |                    ^
          778|

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/lists.nix:777:26:
          776|   */
          777|   optional = cond: elem: if cond then [ elem ] else [ ];
             |                          ^
          778|

       … in the left operand of the AND (&&) operator
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:542:42:
          541|           concatLists [
          542|             (optional (type == "oneshot" && (restart == "always" || restart == "on-success"))
             |                                          ^
          543|               "Service '${name}.service' with 'Type=oneshot' cannot have 'Restart=always' or 'Restart=on-success'"

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/nixos/modules/system/boot/systemd.nix:537:20:
          536|           let
          537|             type = service.serviceConfig.Type or "";
             |                    ^
          538|             restart = service.serviceConfig.Restart or "no";

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `systemd.services.home-manager-hunter.serviceConfig':

       … while evaluating the attribute 'mergedValue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1131:5:
         1130|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
         1131|     mergedValue =
             |     ^
         1132|       if isDefined then

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1134:11:
         1133|         if all (def: type.check def.value) defsFinal then
         1134|           type.merge loc defsFinal
             |           ^
         1135|         else

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:831:22:
          830|                 # Non-lazy merge Function
          831|                 loc: defs:
             |                      ^
          832|                 mapAttrs (n: v: v.value) (

       … while calling the 'mapAttrs' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:832:17:
          831|                 loc: defs:
          832|                 mapAttrs (n: v: v.value) (
             |                 ^
          833|                   filterAttrs (n: v: v ? value) (

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:833:19:
          832|                 mapAttrs (n: v: v.value) (
          833|                   filterAttrs (n: v: v ? value) (
             |                   ^
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)

       … while calling 'filterAttrs'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:23:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                       ^
          658|

       … while calling the 'removeAttrs' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:28:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                            ^
          658|

       … while calling the 'filter' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:45:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                             ^
          658|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:53:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                     ^
          658|

       … in the argument of the not operator
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:60:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                            ^
          658|

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:60:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                            ^
          658|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:833:35:
          832|                 mapAttrs (n: v: v.value) (
          833|                   filterAttrs (n: v: v ? value) (
             |                                   ^
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:657:70:
          656|   */
          657|   filterAttrs = pred: set: removeAttrs set (filter (name: !pred name set.${name}) (attrNames set));
             |                                                                      ^
          658|

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:834:41:
          833|                   filterAttrs (n: v: v ? value) (
          834|                     zipAttrsWith (name: defs: (mergeDefinitions (loc ++ [ name ]) elemType (defs)).optionalValue)
             |                                         ^
          835|                       # Push down position info.

       … while evaluating the attribute 'optionalValue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1148:5:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |     ^
         1149|   };

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1148:21:
         1147|
         1148|     optionalValue = if isDefined then { value = mergedValue; } else { };
             |                     ^
         1149|   };

       (8 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/nixos':

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1110:80:
         1109|               }
         1110|           ) (addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                ^
         1111|         ) defs;

       … while calling 'dischargeProperties'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1203:5:
         1202|   dischargeProperties =
         1203|     def:
             |     ^
         1204|     if def._type or "" == "merge" then

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1204:5:
         1203|     def:
         1204|     if def._type or "" == "merge" then
             |     ^
         1205|       concatMap dischargeProperties def.contents

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/types.nix:774:15:
          773|               inherit (def) file;
          774|               value = v;
             |               ^
          775|             }) def.value

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'home-manager-generation'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'buildCommand' of derivation 'home-manager-generation'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:80:17:
           79|         enableParallelBuilding = true;
           80|         inherit buildCommand name;
             |                 ^
           81|         passAsFile = [ "buildCommand" ] ++ (derivationArgs.passAsFile or [ ]);

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'activation-script'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'text' of derivation 'activation-script'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:129:13:
          128|           inherit
          129|             text
             |             ^
          130|             executable

       … while calling the 'concatStringsSep' builtin
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/home-environment.nix:725:13:
          724|           if sortedCommands ? result then
          725|             lib.concatStringsSep "\n" (map mkCmd sortedCommands.result)
             |             ^
          726|           else

       … while calling 'mkCmd'
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/home-environment.nix:718:17:
          717|       let
          718|         mkCmd = res: ''
             |                 ^
          719|           _iNote "Activating %s" "${res.name}"

       … while evaluating the attribute 'data'
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/lib/dag.nix:100:45:
           99|       {
          100|         result = map (v: { inherit (v) name data; }) sorted.result;
             |                                             ^
          101|       }

       … while evaluating the attribute 'data'
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/lib/dag.nix:92:9:
           91|         name = n;
           92|         data = v.data;
             |         ^
           93|         after = v.after ++ dagBefore dag n;

       … from call site
         at /nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/lib/dag.nix:92:16:
           91|         name = n;
           92|         data = v.data;
             |                ^
           93|         after = v.after ++ dagBefore dag n;

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1182:17:
         1181|         mapAttrs (
         1182|           name: value:
             |                 ^
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/attrsets.nix:1183:85:
         1182|           name: value:
         1183|           if isAttrs value && cond value then recurse (path ++ [ name ]) value else f (path ++ [ name ]) value
             |                                                                                     ^
         1184|         );

       … while calling anonymous lambda
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:273:71:
          272|           # For definitions that have an associated option
          273|           declaredConfig = mapAttrsRecursiveCond (v: !isOption v) (_: v: v.value) options;
             |                                                                       ^
          274|

       … while evaluating the attribute 'value'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/modules.nix:1084:7:
         1083|     // {
         1084|       value = addErrorContext "while evaluating the option `${showOption loc}':" value;
             |       ^
         1085|       inherit (res.defsFinal') highestPrio;

       … while evaluating the option `home-manager.users.hunter.home.activation.installPackages.data':

       (10 duplicate frames omitted)

       … while evaluating definitions from `/nix/store/jhg28z2k6wjx2f0iyv88mrd1hg404szq-source/modules/home-environment.nix':

       (6 duplicate frames omitted)

       … while evaluating derivation 'home-manager-path'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'passAsFile' of derivation 'home-manager-path'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:81:9:
           80|         inherit buildCommand name;
           81|         passAsFile = [ "buildCommand" ] ++ (derivationArgs.passAsFile or [ ]);
             |         ^
           82|       }

       … while evaluating the attribute 'passAsFile'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:9:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |         ^
          114|       }

       … while evaluating a branch condition
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:22:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                      ^
          114|       }

       … in the argument of the not operator
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:52:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                                                    ^
          114|       }

       … while calling the 'lessThan' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:52:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                                                    ^
          114|       }

       … while calling the 'stringLength' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:113:25:
          112|         # XXX: The size is somewhat arbitrary
          113|         passAsFile = if builtins.stringLength pkgs >= 128 * 1024 then [ "pkgs" ] else [ ];
             |                         ^
          114|       }

       … while calling the 'toJSON' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:108:16:
          107|           ;
          108|         pkgs = builtins.toJSON chosenOutputs;
             |                ^
          109|         extraPathsFrom = lib.optional includeClosures (writeClosure pathsForClosure);

       … while evaluating list element at index 46

       … while evaluating attribute 'paths'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:68:7:
           67|     chosenOutputs = map (drv: {
           68|       paths =
             |       ^
           69|         # First add the usual output(s): respect if user has chosen explicitly,

       … while evaluating list element at index 0
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/buildenv/default.nix:68:7:
           67|     chosenOutputs = map (drv: {
           68|       paths =
             |       ^
           69|         # First add the usual output(s): respect if user has chosen explicitly,

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'lutris-0.5.19'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'buildCommand' of derivation 'lutris-0.5.19'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:80:17:
           79|         enableParallelBuilding = true;
           80|         inherit buildCommand name;
             |                 ^
           81|         passAsFile = [ "buildCommand" ] ++ (derivationArgs.passAsFile or [ ]);

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'lutris-0.5.19-bwrap'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'text' of derivation 'lutris-0.5.19-bwrap'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/trivial-builders/default.nix:129:13:
          128|           inherit
          129|             text
             |             ^
          130|             executable

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/default.nix:326:43:
          325|
          326|   bin = writeShellScript "${name}-bwrap" (bwrapCmd {
             |                                           ^
          327|     initArgs = ''"$@"'';

       … while calling 'bwrapCmd'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/default.nix:175:5:
          174|   bwrapCmd =
          175|     {
             |     ^
          176|       initArgs ? "",

       … while calling the 'getAttr' builtin
         at <nix/derivation-internal.nix>:50:17:
           49|     value = commonAttrs // {
           50|       outPath = builtins.getAttr outputName strict;
             |                 ^
           51|       drvPath = strict.drvPath;

       … while calling the 'derivationStrict' builtin
         at <nix/derivation-internal.nix>:37:12:
           36|
           37|   strict = derivationStrict drvAttrs;
             |            ^
           38|

       … while evaluating derivation 'lutris-0.5.19-fhsenv-rootfs'
         whose name attribute is located at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/make-derivation.nix:480:13

       … while evaluating attribute 'exportReferencesGraph' of derivation 'lutris-0.5.19-fhsenv-rootfs'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/buildFHSEnv.nix:215:9:
          214|         __structuredAttrs = true;
          215|         exportReferencesGraph.graph = lib.concatMap (p: p.paths) allPaths;
             |         ^
          216|         inherit

       … while evaluating attribute 'graph'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/buildFHSEnv.nix:215:9:
          214|         __structuredAttrs = true;
          215|         exportReferencesGraph.graph = lib.concatMap (p: p.paths) allPaths;
             |         ^
          216|         inherit

       … while evaluating list element at index 225
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/build-support/build-fhsenv-bubblewrap/buildFHSEnv.nix:215:9:
          214|         __structuredAttrs = true;
          215|         exportReferencesGraph.graph = lib.concatMap (p: p.paths) allPaths;
             |         ^
          216|         inherit

       … in the condition of the assert statement
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/lib/customisation.nix:401:15:
          400|             outPath =
          401|               assert condition;
             |               ^
          402|               drv.${outputName}.outPath;

       … while evaluating the attribute 'handled'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/check-meta.nix:643:9:
          642|         # or, alternatively, just output a warning message.
          643|         handled = (
             |         ^
          644|           if valid == "yes" then

       … from call site
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/check-meta.nix:647:14:
          646|           else if valid == "no" then
          647|             (handleEvalIssue { inherit meta attrs; } { inherit (validity) reason errormsg; })
             |              ^
          648|           else if valid == "warn" then

       … while calling 'handleEvalIssue'
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/check-meta.nix:291:5:
          290|     { meta, attrs }:
          291|     {
             |     ^
          292|       reason,

       … while calling the 'throw' builtin
         at /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/stdenv/generic/check-meta.nix:308:5:
          307|     in
          308|     handler msg;
             |     ^
          309|

       error: Package ‘steam’ in /nix/store/khwrmv3vkmc60ig18h90rf0iadis95na-source/pkgs/by-name/st/steam/package.nix:169 has an unfree license (‘unfreeRedistributable’), refusing to evaluate.

       a) To temporarily allow unfree packages, you can use an environment variable
          for a single invocation of the nix tools.

            $ export NIXPKGS_ALLOW_UNFREE=1

          Note: When using `nix shell`, `nix build`, `nix develop`, etc with a flake,
                then pass `--impure` in order to allow use of environment variables.

       b) For `nixos-rebuild` you can set
         { nixpkgs.config.allowUnfree = true; }
       in configuration.nix to override this.

       Alternatively you can configure a predicate to allow specific packages:
         { nixpkgs.config.allowUnfreePredicate = pkg: builtins.elem (lib.getName pkg) [
             "steam"
           ];
         }

       c) For `nix-env`, `nix-build`, `nix-shell` or any other Nix command you can add
         { allowUnfree = true; }
       to ~/.config/nixpkgs/config.nix.
